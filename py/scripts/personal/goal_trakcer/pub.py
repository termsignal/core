# curl --request POST \
#   'https://pubsub.googleapis.com/v1/projects/chilos-terminal/topics/apple_activity:publish?key=AIzaSyBBoI8vXd5TEOLC3V-TjFVW1AVT4MkRXo8' \
#   --header 'Accept: application/json' \
#   --header 'Content-Type: application/json' \


import requests
import json

import os

os.environ["GOOGLE_APPLICATION_CREDENTIALS"] = "creds.json"
url = "https://pubsub.googleapis.com/v1/projects/chilos-terminal/topics/apple_activity:publish?key=AIzaSyBBoI8vXd5TEOLC3V-TjFVW1AVT4MkRXo8"

headers = {"Authorization": "Bearer LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tXG5NSUlFdkFJQkFEQU5CZ2txaGtpRzl3MEJBUUVGQUFTQ0JLWXdnZ1NpQWdFQUFvSUJBUUMvRVJVcjgyMW1hR2pxXG5tTGZac0YyQllrQ0Rpdk1lTXVvWDlzUDJyNGR0YnJISGhXdENVNTRUcHVjTU00RlltanFUVSsxeWkrZmVyMnFvXG51OUxpaHNlbnR2VFQ2SlpwZmxUaTR1NjN1QS93Qk4xbmJHUC9xZDV5a2NlckNYSFpwVk1oWENycnRBd2pvMHl2XG52b0dYM09zb2pseWVrMFl0UWx4eElGb0t3N0dGbTVqUkc0Q3RwQ3JLeE9NeDJqcXBlTjRTMEZ2THpzS09IS3ZsXG51dUxpK3FpMUxWMm8zVlgxTWEvSThGLzRjckkzZUtYOHNMN1I5TGpYOWRTQXFvcTVGMFh3UEpUWjlmaDhzV2JtXG5DS2ZTK2Q3WnEydmFiNnpkeVBOa3VMb3lnSDBPakFkdCtvZDh5ZEh4UjYvR0hMU0JoKzVIeDJMa1hBNkx2VzBrXG5rZ1RPSmpVRkFnTUJBQUVDZ2dFQUl2ZWpZa25JcWNkTi9ERTY1SElzaXJOS2owaHN1Z2dqWTROYjFkZkY5emNjXG4vaURpd2w2L1BXVjhQM1ZscEt1Rk1OVlpUVzloWGhYSWRWejZlVTZsVjRKYVNEWDI0Uk9ud1dZNnZoREhpZXU2XG5BV1dLMzQxZEVxYXZYaFA2YkJTZnBDbFVDWk1IN2JYRElSN0NaT0tmZnVxZTlMNkxSMWt2eGR4ZjNqeDJUcmNjXG5JTG1tbHBFYXVaRDZXdkM4bm1FSTNxOFg2V3JZOGRxeEtnaFlyc3Bscnh3SVg2STVGVFgrc1RHb3pMU3p6WHN6XG5jYjJpRUZ1MGxsUU15OG1XMU83TkcxV2xvNFdNdTh3OWZwQWVkYkJvV1NGdjF0YjgzcG92YWI0TU9ZYUQySUlKXG5NeVVIUFVDa2pqVFZhSkFzU0dJZ0w4ME1xZjJrMnFzNVRTVmlhZDFMZ1FLQmdRRHJ2RTYzU01xckZPbURHQnJyXG5oeUFMWWE4SnJGOG56cHJBRHJ3a0NtcllSRWNWclpwVFZOalJRbGM1Y3RZbm9mS1BaUGlwYWJkT0pUdFBjc21FXG53YXFMcGxBVzc0c2QzYWlZb2ZHcGNNWk10SVJUTXcwaEhMbVRNTGRkNDAwMndDZUZmR0czUmZLNWphWUNrZkpXXG5UTE80eVZnaVA0T1k1cUlGSUNnTEwyZUIxUUtCZ1FEUGZjWkZKRS9ZVyt0dGdhQnBrN0RuaDVoelI4MTN1cHNyXG51bktBQnhHVFhYQ1o4eGg2U3YybG85VC95ODBjQktsMDlLdXFZM2E2QXdMYUY1cUlQVG82R0FGallhbU9wb2JWXG4rYkZmMkN3dlgvczhLaFAycDFiZ3ZRQ3RvNThUUmEvUXcyZFVhYm9TVHpKd21ZUUpsanY0cWord0tsMzRPSXkrXG5YZ0JmMU10T2NRS0JnRDJmb0VReGR5bDU4Z0VmRUFwNTdGcU5VcUNJdXVkQkR4c2R2dmo4OENsUXovUk95WVQzXG5MU2FtM1A1YmtyZ1JrY01DZGk1elFFUGhYN3ZKR2Z6bVU1cm1BeEc3MVBZZHQ3RU94SW15dldQWDNLK1RMTjkzXG5EdHYzWkRmYTc1aGNhdmh1SjIwdGorSUpzVmdDcHdNQVVnc0FOMVhjbko0ZnpFTGl3UlVMYzFkeEFvR0FlVWZZXG5NNlAwODg5T3ZsUnRraWljMThoL1NLcm9vNW8waHd2VlQ1WlNKS1FTWkRvZXphUzF2RE1XRm1wbXVvRFRHQ1RIXG5qckhTdlFsemlrMFBxNkMyUHl5MjZ3TXoyOGprdVgvWXVPQWZlNVdMd1hBSytUcDQ0cVkzRmtlMGZNeFg1eHZBXG5jeXZWY2t4T2ZGaVBRQmRMZUo3eTJTTDZpRk50bVB4VEZiREpJVkVDZ1lCbmFBSzhiRlRxQ21ydWdFY0pPWFJ3XG42Q2hXOXh6Z1JQMUJ0aGhmUHJ2cCtkVFZUY0wvbXpEdDB6YnIwbXgwS0NyQTBHLzJiZTBsaFhVeHZNMnVoMzhxXG44T05ZSmlJeXNsRXhBZFU1QUZ6RVpuU1REcHJ5QjF2QVVVNVh3aFBCc3RoOWgwL09GV2RqYVFZT3BPa0Vka2hWXG56VmJjVVdTRDJjZXd1aXB6cS90bU5BPT1cbi0tLS0tRU5EIFBSSVZBVEUgS0VZLS0tLS1cbg==", "Content-Type": "application/json", "Accept": "application/json"}

data = {"messages": [{"data": "aGVsbG9vbw=="}]}

response = requests.post(url, headers=headers, json=data)

print("Status Code", response.status_code)
print("JSON Response ", response.json())

gcloud pubsub topics publish apple_activity \
  --message={"key": key}